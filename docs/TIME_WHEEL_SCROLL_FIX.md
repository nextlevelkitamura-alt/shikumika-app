# Time Wheel Scroll Fix Plan
**作成日**: 2026-01-25  
**目的**: 時間ホイールで最後の要素（23時、55分）を青背景（中央ハイライトバンド）に移動できるように修正

---

## 📋 問題点

### 現状の問題
- 時間ホイールで中間の時間（例: 12時、30分）を選択 → ✅ 青背景に移動する
- 時間ホイールで最後の時間（例: 23時、55分）を選択 → ❌ 青背景まで移動しない

### 原因分析
`scrollIntoView({ block: 'center' })` を使用していますが、スクロール可能領域の最後の要素は物理的に中央まで移動できません。

**現在の設定**:
- ホイール高さ: `h-[240px]` (240px)
- 上下パディング: `py-14` (56px)
- 中央ハイライトバンド位置: 画面の真ん中 (120px)

**問題**:
- 最後の要素をスクロールしても、下部のパディング（56px）が不足しているため、中央（120px）まで到達できない

---

## 🎯 解決策

### アプローチ
スクロール可能領域の**上下パディング**を増やして、最後の要素でも中央に配置できるようにする

### 必要なパディング計算
```
ホイール高さ: 240px
中央位置: 240px / 2 = 120px
ボタン高さ: h-8 = 32px (w-8 h-8)

最後の要素を中央に配置するために必要な下部パディング:
= 中央位置 - (ボタン高さ / 2)
= 120px - 16px
= 104px

安全マージンを含めて: 120px 程度
```

### 実装方針
1. `py-14` (56px) → `py-[120px]` (120px) に変更
2. これにより、最初の要素と最後の要素の両方が中央に配置可能になる

---

## 🔧 修正内容

### 変更ファイル
- `src/components/ui/date-time-picker.tsx` (TimeWheel コンポーネント)

### Before (現在のコード):
```tsx
{/* Hours */}
<ScrollArea className="h-full flex-1">
    <div className="flex flex-col items-center py-14 space-y-1">
        {/* ... */}
    </div>
</ScrollArea>

{/* Minutes */}
<ScrollArea className="h-full flex-1">
    <div className="flex flex-col items-center py-14 space-y-1">
        {/* ... */}
    </div>
</ScrollArea>
```

### After (修正後のコード):
```tsx
{/* Hours */}
<ScrollArea className="h-full flex-1">
    <div className="flex flex-col items-center py-[120px] space-y-1">
        {/* ... */}
    </div>
</ScrollArea>

{/* Minutes */}
<ScrollArea className="h-full flex-1">
    <div className="flex flex-col items-center py-[120px] space-y-1">
        {/* ... */}
    </div>
</ScrollArea>
```

**変更点**:
- `py-14` (56px) → `py-[120px]` (120px)

---

## 📐 視覚的イメージ

### 修正前:
```
┌─────────────────┐
│  Fade (12px)    │ ← グラデーション
│                 │
│  Padding (56px) │ ← 不足している
│                 │
│  00時           │
│  01時           │
│  ...            │
│  21時           │
│  22時           │
│ [23時]          │ ← 最後の要素
├─────────────────┤ ← 青背景（中央）まで届かない
│  Padding (56px) │ ← 不足している
│                 │
│  Fade (12px)    │
└─────────────────┘
```

### 修正後:
```
┌─────────────────┐
│  Fade (12px)    │ ← グラデーション
│                 │
│  Padding (120px)│ ← 十分なパディング
│                 │
│  00時           │
│  01時           │
│  ...            │
│  21時           │
│  22時           │
├─────────────────┤ ← 青背景（中央）
│ [23時]          │ ← 最後の要素が中央に配置可能
│                 │
│  Padding (120px)│ ← 十分なパディング
│                 │
│  Fade (12px)    │
└─────────────────┘
```

---

## ✅ 実装手順

### Phase 1: パディングの調整
1. `date-time-picker.tsx` の `TimeWheel` コンポーネントを修正
2. 時間（hours）のパディング: `py-14` → `py-[120px]`
3. 分（minutes）のパディング: `py-14` → `py-[120px]`

### Phase 2: 動作確認
1. 最初の要素（00時、00分）を選択 → 中央に配置されるか
2. 中間の要素（12時、30分）を選択 → 中央に配置されるか
3. 最後の要素（23時、55分）を選択 → 中央に配置されるか

---

## 🎯 期待される結果

### 修正前:
- ❌ 23時を選択 → 青背景まで移動しない
- ❌ 55分を選択 → 青背景まで移動しない

### 修正後:
- ✅ 00時を選択 → 青背景に配置される
- ✅ 12時を選択 → 青背景に配置される
- ✅ 23時を選択 → 青背景に配置される
- ✅ 00分を選択 → 青背景に配置される
- ✅ 30分を選択 → 青背景に配置される
- ✅ 55分を選択 → 青背景に配置される

---

## ⚠️ 注意事項

1. **パディング値の調整**
   - `py-[120px]` は、ホイール高さ（240px）の半分
   - ボタンの高さ（32px）を考慮しても十分な余白

2. **スクロール可能領域の増加**
   - パディングが増えると、スクロール可能な領域も増える
   - これは意図した動作（最後の要素を中央に配置するため）

3. **初期表示位置**
   - 既存の `scrollIntoView` ロジックがあるため、初期表示時も正しい位置にスクロールされる

---

## 🧪 テストケース

1. **最初の要素**:
   - 00時を選択 → 中央に配置される
   - 00分を選択 → 中央に配置される

2. **中間の要素**:
   - 12時を選択 → 中央に配置される
   - 30分を選択 → 中央に配置される

3. **最後の要素**:
   - 23時を選択 → 中央に配置される（修正対象）
   - 55分を選択 → 中央に配置される（修正対象）

---

この計画で実装を進めます。
