# Simplify Task Details Display Plan
**作成日**: 2026-01-25  
**目的**: カレンダーと優先度の表示をよりシンプルにする

---

## 📋 要件

### 現在の問題点
- ✅ 優先度設定済み: `[中] [×] [🎯]` ← アイコンが冗長
- ✅ 日時設定済み: `[1/26 09:45] [×] [📅]` ← アイコンが冗長
- ❌ タスクの内容がシンプルでない

### 改善要望
- 設定後はアイコンを削除
- 詳細テキストのみ表示
- 詳細テキストをクリック → 変更できる（ポップオーバーが開く）
- × ボタンで削除

---

## 🎯 目標UX

### A. タスクリスト（center-pane.tsx）

#### 未設定時
```
[タスク名] ⏱ 00:15:00 [▶ フォーカス] [🎯] [📅]
                                        ↑   ↑
                                   グレーのアイコン（hover時）
```

#### 設定済み時（優先度のみ）
```
[タスク名] ⏱ 00:15:00 [▶ フォーカス] [中] [×] [📅]
                                        ↑   ↑   ↑
                                      クリック 削除 日時未設定
```

#### 設定済み時（日時のみ）
```
[タスク名] ⏱ 00:15:00 [▶ フォーカス] [🎯] [1/26 09:45] [×]
                                        ↑    ↑          ↑
                                   優先度未設定 クリック  削除
```

#### 設定済み時（両方設定）
```
[タスク名] ⏱ 00:15:00 [▶ フォーカス] [中] [×] [1/26 09:45] [×]
                                        ↑   ↑    ↑          ↑
                                      クリック 削除 クリック  削除
```

**アイコン（🎯 と 📅）は削除！**

### B. マインドマップ（mind-map.tsx）

#### 未設定時
```
[タスク名] [🎯] [📅]
            ↑   ↑
       グレーのアイコン
```

#### 設定済み時（優先度のみ）
```
[タスク名] [中] [×] [📅]
            ↑   ↑   ↑
          クリック 削除 日時未設定
```

#### 設定済み時（日時のみ）
```
[タスク名] [🎯] [1/26 09:45] [×]
            ↑    ↑          ↑
       優先度未設定 クリック  削除
```

#### 設定済み時（両方設定）
```
[タスク名] [中] [×] [1/26 09:45] [×]
            ↑   ↑    ↑          ↑
          クリック 削除 クリック  削除
```

**アイコン（🎯 と 📅）は削除！**

---

## 🎨 デザイン詳細

### 詳細テキストのクリック可能化

#### 優先度バッジ（クリック可能）
```tsx
// Before: クリック不可
<PriorityBadge value={task.priority as Priority} />

// After: クリック可能（ポップオーバーのトリガー）
<PriorityPopover
    value={task.priority as Priority}
    onChange={(priority) => onUpdateTask?.(task.id, { priority })}
    trigger={
        <span className="cursor-pointer">
            <PriorityBadge value={task.priority as Priority} />
        </span>
    }
/>
```

#### 日時テキスト（既にクリック可能）
```tsx
// 既に DateTimePicker の trigger として機能している
<DateTimePicker
    trigger={
        <div className="flex items-center gap-1">
            <span className="cursor-pointer">1/26 09:45</span>
            <Button>×</Button>
        </div>
    }
/>
```

**変更点**: カレンダーアイコン（📅）を削除

---

## 🔧 実装内容

### Phase 1: center-pane.tsx の修正

#### Before（現在の実装）:
```tsx
{task.priority ? (
    <>
        <PriorityBadge value={task.priority as Priority} />
        <Button onClick={() => clear()}>×</Button>
        <PriorityPopover trigger={<Button>🎯</Button>} />
    </>
) : (
    <PriorityPopover trigger={<Button>🎯</Button>} />
)}

{task.scheduled_at ? (
    <DateTimePicker trigger={
        <div>
            <span>1/26 09:45</span>
            <Button>×</Button>
            <Button>📅</Button>
        </div>
    } />
) : (
    <DateTimePicker trigger={<Button>📅</Button>} />
)}
```

#### After（修正後）:
```tsx
{/* Priority Group */}
{task.priority ? (
    <>
        {/* Priority Badge (clickable) */}
        <PriorityPopover
            value={task.priority as Priority}
            onChange={(priority) => onUpdateTask?.(task.id, { priority })}
            trigger={
                <span className="cursor-pointer">
                    <PriorityBadge value={task.priority as Priority} />
                </span>
            }
        />
        
        {/* Clear Button */}
        <Button>×</Button>
    </>
) : (
    /* Priority not set: Icon only */
    <PriorityPopover trigger={<Button>🎯</Button>} />
)}

{/* Date Group */}
{task.scheduled_at ? (
    <>
        {/* Date Text (clickable) */}
        <DateTimePicker trigger={
            <div className="flex items-center gap-1">
                <span className="cursor-pointer">1/26 09:45</span>
                <Button>×</Button>
            </div>
        } />
        {/* 📅 アイコンを削除 */}
    </>
) : (
    /* Date not set: Icon only */
    <DateTimePicker trigger={<Button>📅</Button>} />
)}
```

**変更点**:
1. 優先度設定済み: `[中] [×]` のみ（🎯 削除）
2. 日時設定済み: `[1/26 09:45] [×]` のみ（📅 削除）
3. `[中]` バッジをクリック可能にする（ポップオーバーのトリガー）

### Phase 2: mind-map.tsx の修正

同様の変更を `mind-map.tsx` にも適用します。

---

## 📊 Before / After 比較

### Before（現在）
```
優先度設定済み: [中] [×] [🎯]
日時設定済み:   [1/26 09:45] [×] [📅]

タスク例:
[タスクA] [中] [×] [🎯] [1/26 09:45] [×] [📅]
          ↑   ↑   ↑    ↑          ↑   ↑
        バッジ 削除 アイコン テキスト  削除 アイコン
```

### After（修正後）
```
優先度設定済み: [中] [×]
日時設定済み:   [1/26 09:45] [×]

タスク例:
[タスクA] [中] [×] [1/26 09:45] [×]
          ↑   ↑    ↑          ↑
        クリック 削除 クリック  削除
```

**結果**:
- アイコン（🎯 📅）が削除され、よりシンプル
- クリック可能領域が明確（詳細テキスト）
- 視覚的にクリーン

---

## 🎯 実装順序

### Phase 1: center-pane.tsx の修正
1. 優先度設定済み時、🎯 アイコンを削除
2. 優先度バッジをクリック可能にする（`PriorityPopover` の `trigger` として使用）
3. 日時設定済み時、📅 アイコンを削除
4. 日時テキストは既にクリック可能（変更不要）

### Phase 2: mind-map.tsx の修正
1. 優先度設定済み時、🎯 アイコンを削除
2. 優先度バッジをクリック可能にする
3. 日時設定済み時、📅 アイコンを削除
4. 日時テキストは既にクリック可能（変更不要）

### Phase 3: 動作確認
1. 優先度未設定 → 🎯 アイコンのみ表示（グレー）
2. 優先度設定 → `[中] [×]` 表示、🎯 アイコン削除
3. `[中]` をクリック → ポップオーバーで変更可能
4. × ボタン → 優先度削除
5. 日時未設定 → 📅 アイコンのみ表示（グレー）
6. 日時設定 → `[1/26 09:45] [×]` 表示、📅 アイコン削除
7. `[1/26 09:45]` をクリック → カレンダーで変更可能
8. × ボタン → 日時削除

---

## 🎨 視覚的イメージ

### タスクリスト

#### Before（現在）
```
┌─────────────────────────────────────────────────────────┐
│ ☐ [タスクA] ⏱ [▶] [中][×][🎯] [1/26 09:45][×][📅]│
│                     ↑  ↑  ↑    ↑          ↑  ↑      │
│                   冗長なアイコン                      │
└─────────────────────────────────────────────────────────┘
```

#### After（修正後）
```
┌──────────────────────────────────────────────┐
│ ☐ [タスクA] ⏱ [▶] [中][×] [1/26 09:45][×]│
│                     ↑  ↑    ↑          ↑   │
│                   シンプル＆クリック可能    │
└──────────────────────────────────────────────┘
```

### マインドマップ

#### Before（現在）
```
┌────────────────────────────────────┐
│ [タスクA]                          │
│ [中][×][🎯] [1/26 09:45][×][📅]│
│  ↑  ↑  ↑    ↑          ↑  ↑    │
│    冗長なアイコン                  │
└────────────────────────────────────┘
```

#### After（修正後）
```
┌──────────────────────────────┐
│ [タスクA]                    │
│ [中][×] [1/26 09:45][×]    │
│  ↑  ↑    ↑          ↑      │
│  シンプル＆クリック可能      │
└──────────────────────────────┘
```

---

## ⚠️ 注意事項

1. **クリック可能領域**
   - 優先度バッジ `[中]` をクリック → ポップオーバーが開く
   - 日時テキスト `[1/26 09:45]` をクリック → カレンダーが開く（既に実装済み）

2. **× ボタンのクリック伝播防止**
   - `e.stopPropagation()` を必ず呼ぶ
   - × ボタンをクリックしても、ポップオーバーが開かないようにする

3. **未設定時のアイコン表示**
   - 優先度未設定: 🎯 アイコンのみ（グレー、hover時表示）
   - 日時未設定: 📅 アイコンのみ（グレー、hover時表示）

4. **既存の実装との整合性**
   - 日時テキストは既に `DateTimePicker` の `trigger` として機能している
   - 優先度バッジも同様に `PriorityPopover` の `trigger` として使用する

---

## ✅ 完了条件

- [ ] Phase 1: center-pane.tsx の修正
  - [ ] 優先度設定済み時、🎯 アイコンを削除
  - [ ] 優先度バッジをクリック可能にする
  - [ ] 日時設定済み時、📅 アイコンを削除
- [ ] Phase 2: mind-map.tsx の修正
  - [ ] 優先度設定済み時、🎯 アイコンを削除
  - [ ] 優先度バッジをクリック可能にする
  - [ ] 日時設定済み時、📅 アイコンを削除
- [ ] Phase 3: 動作確認
  - [ ] 優先度バッジをクリック → ポップオーバーが開く
  - [ ] 日時テキストをクリック → カレンダーが開く
  - [ ] × ボタンで削除できる
  - [ ] アイコンが設定後に表示されない

---

この計画で実装を進めます。
