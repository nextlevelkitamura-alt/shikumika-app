# カレンダーUI仕様書 (V6.1 - Implementable Spec + Visual Fidelity)

本ドキュメントは、`DateTimePicker` コンポーネントのUIデザイン仕様を「**実装可能**」かつ「**崩れない**」形で定義するものです。
今後の改修時は本仕様を Single Source of Truth としてください。

## 1. デザインコンセプト
**「モダン・コンパクト・整列」**
マインドマップのエディタ画面において、カレンダーが主張しすぎず、かつ高い操作性と美観を持つことを目的としています。

## 2. 完成イメージ（ゴール）
![カレンダーデザイン案 V5](/Users/kitamuranaohiro/.gemini/antigravity/brain/ae202690-1d57-4589-90f2-81dfc57e7d3a/calendar_mockup_v5_1769259933839.png)

---

## 3. 実装仕様 (Technical Specs)

### 0. 決定事項（今回の合意）
- **週の開始**: 日曜日（`weekStartsOn = 0`）
- **outside days（前後月の日付）**: **薄く表示**し、**クリック不可**
- **fixedWeeks**: **ON**（常に6週表示で高さを安定させる）

### 0.1 目標UIの「見た目」の決定事項（追加）
- **月ヘッダー**: 上部中央に `yyyy年M月` を表示し、左右に前月/翌月の矢印ボタンを配置する（iOS/カレンダー風）。
- **今日（Today）**: 薄いリング（円枠）で示す（塗りつぶしではない）。
- **選択日（Selected）**:
  - 角丸の矩形（rounded-md〜lg）で**淡いブルーのグロー**を伴うハイライト。
  - テキストは白。背景は透明感のあるブルー系。
- **outside days**:
  - 通常日より明確に薄い（opacity/色）。
  - **クリック不可**。
- **時間ホイールの中央強調**:
  - 中央行に横長のハイライト帯（角丸）を敷き、選択中の時刻を強調する（画像の横長ハイライト）。
  - 上下は薄い文字色でフェード。
- **時間ホイールの上下矢印**:
  - 上下に「▲/▼」相当のインジケータを表示（スクロール可能であることの示唆）。

### A. カレンダーエリア (左側)
*   **レイアウト**: `table-layout: fixed` を必須とする。
    *   目的: 曜日ヘッダーと日付セルの垂直ラインを1pxの狂いもなく揃えるため。
    *   禁止事項: 個別セル(`td`, `th`)への固定幅(`w-9`等)の指定。ブラウザの自動等分計算を阻害するため。
    *   推奨: `table` に `table-fixed`、`day` は **`w-full` + `aspect-square`**（セル幅に追従させる）。
*   **ヘッダー**: `ja` ロケール標準の「日 月 火 水 木 金 土」を表示する。
    *   `weekStartsOn` は **0（日曜）**に固定する。
*   **outside days**:
    *   表示はする（薄く）。
    *   **クリック不可**（`pointer-events: none` 相当）。
    *   目的: 1週目/最終週の「歯抜け感」を消し、列揃えと視認性を安定させる。
*   **fixedWeeks**:
    *   **ON**（6行固定）。
    *   目的: 月送り時にポップオーバーの高さがガクつかないようにする。
*   **デザイン**:
    *   背景: ダークグレー (`#18181b`)
    *   文字色: 白 (選択日は反転)
    *   選択日: 反転（背景ライト/文字ダーク）で明確に。
    *   曜日ヘッダー: 薄いグレー（例: `#9ca3af` 相当）、文字サイズは小さめ（`text-xs` 相当）。
    *   余白: カレンダー内の余白は「詰めすぎず、空きすぎず」。目標画像の密度を基準にする。

### B. 時間ホイールエリア (右側)
*   **レイアウト**: 2カラム構成 (時 / 分)。
*   **サイズ**: 幅は **約90px** に固定。カレンダー部分（約240-280px）に対して「細いサイドバー」としての比率を保つ。
*   **要素**:
    *   **時 (Hours)**: 00-23
    *   **分 (Minutes)**: **5分刻み** (00, 05, 10... 55)
*   **インタラクション**:
    *   選択中の数字（中央）を白文字・背景ハイライトで強調する。
    *   上下に十分なパディングを取り、視線が中央に集中するようデザインする。
    *   ただし「余白だらけ」に見えないよう、ポップオーバー全体の高さとのバランスを保つ。
    *   中央ハイライト帯は「時/分の両列をまたいで」横長に敷けるようにする（画像の見え方優先）。

### C. アクションフッター (下部)
*   **配置**: ポップオーバーの最下部にボーダー区切りで配置。
*   **ボタン**:
    *   左: **キャンセル** (Ghost variant)
    *   右: **設定** (Primary/White variant)
    *   **重要**: 文字サイズは `text-xs` 〜 `text-sm`。巨大なボタンにせず、ツールチップのような繊細さを維持する。

---

## 4. 実装ガイド（落とし込みルール）
### A. 7列整列のルール（崩れないための最重要）
- `table` 側で列幅の等分を成立させる（`table-fixed`）。
- `td/th` に固定幅を付けない（`w-9` 等禁止）。
- `day` は `w-full` でセルに追従し、正方形は `aspect-square` で担保する（固定pxで担保しない）。

### B. outside days / fixedWeeks の設定
- `showOutsideDays = true`（薄く表示）
- outside days の日付は `pointer-events: none` で無効化（誤操作防止）
- `fixedWeeks = true`

---

## 5. 受け入れ条件（これを満たしたら完成）
1. 曜日ヘッダーと日付セルの縦ラインが **目視でズレない**（日だけ離れる等がない）。
2. outside days は薄く表示されるが、クリックしても選択されない。
3. 月送りしても、ポップオーバーの高さがガクつかない（fixedWeeks ON）。
4. 時間ホイールは幅約90pxで、中央の選択が明確。かつ余白だらけに見えない。
5. フッターの「キャンセル/設定」が小さく、邪魔にならない。
6. 「今日」はリングで示され、選択日は淡いブルーのグローで強調される（目標画像の印象に近い）。
7. 時間ホイールに上下矢印があり、スクロール可能性が直感的に分かる。

---

## 6. 運用上の注意
*   **変更リスク**: `table-fixed` を外すとレイアウトが崩れる可能性が高いため、安易に変更しないこと。
*   **モバイル対応**: 時間ホイールが細いため、タッチ操作判定エリアが狭くなりすぎないよう注意する（パディング等で確保）。
